<?xml version='1.0' encoding='utf-8'?>
<project version='9' encrypted='1'>
	<steps type='0'>
		<step action='Group'>
			<name>Project steps</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>StartBuild</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>1</indent>
			<name>Log Major Build Stage - Start</name>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>INITIALISE</name>
		</step>
		<step action='Log Message'>
			<Message>Build Type has been set to %BUILD_TYPE%</Message>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Echo Build Type Message</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ClientSxSOverrideLoopCount</MacroName>
			<MacroValue>0</MacroValue>
			<condcompareto>true</condcompareto>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>2</indent>
			<name>Set default ClientSxSOverrideLoopCount to 0</name>
		</step>
		<step action='Set Macro'>
			<MacroEnvVar type='11'>-1</MacroEnvVar>
			<MacroName>__COMPAT_LAYER</MacroName>
			<MacroValue>DisableNXShowUI RunAsAdmin</MacroValue>
			<description><![CDATA[We must override this variable in Visual Build Pro v6.
If we don't, the GUI fails to build the Wix installer with stdafx.cpp compiler errors.]]></description>
			<indent type='3'>2</indent>
			<name>Override __COMPAT_LAYER macro</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>2</indent>
			<name>Check for Shelf info</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>3</indent>
			<name>Check for FastBuildSwitches - only possible if shelf so never have half done release builds</name>
		</step>
		<step action='Set Macro'>
			<MacroName>FastBuildSwitches</MacroName>
			<MacroValue>%READ_INI(%PROJDIR%\BuildTweaks\shelf.ini, ShelfInfo, FastBuildSwitches,"NoSwitches")%</MacroValue>
			<condcompareto>true</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Retrieve FastBuildSwitches from buildtweaks\shelf.INI</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfusateVault</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfusateVault</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfusateVault</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotBuildClients</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotBuildClients</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotBuildClients</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotBuildAzurePackage</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotBuildAzurePackage</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotBuildAzurePackage</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeSQLExpress</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeSQLExpress</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeSQLExpress</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeQuickCache</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeQuickCache</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeQuickCache</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeVaultMSIZip</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeVaultMSIZip</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeVaultMSIZip</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeNUnitSolution</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeNUnitSolution</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeNUnitSolution</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoIncludeDebugBinariesPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoIncludeDebugBinariesPDBs</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoIncludeDebugBinariesPDBs</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeTools</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeTools</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeTools</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeResetServer</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeResetServer</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeResetServer</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeLDAPSync</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeLDAPSync</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeLDAPSync</name>
		</step>
		<step action='Set Macro'>
			<MacroName>SkipClientObfuscation</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>SkipClientObfuscation</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set SkipClientObfuscation</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateQuickCache</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateQuickCache</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateQuickCache</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateTools</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateTools</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateTools</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateResetServer</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateResetServer</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateResetServer</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeSigning</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeSigning</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeSigning</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeMacClient</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeMacClient</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeMacClient</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[****FastBuildSwitches set to: "%FastBuildSwitches%"
]]></Message>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Echo FastBuildSwitches</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoIncludeDebugBinariesPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Always set DoIncludeDebugBinariesPDBs if nightly build</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

"Unit Tests" is set to occur later in this build

]]></Message>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%RUN_UNIT_TESTS%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>2</indent>
			<name>Echo Run unit Tests Message</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BuildSqlProj</MacroName>
			<MacroValue>false</MacroValue>
			<condcompareto>DoNotIncludeNUnitSolution</condcompareto>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>2</indent>
			<name>Set BuildSqlProj to false</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Calculate Release Version</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Normal Non-Vault Branding build</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[<Major>,<Minor> release version]]></MacroDescr>
			<MacroName>RELEASE_VERSION_BASE</MacroName>
			<MacroValue>%READ_INI(%RELEASE_VERSION_INI%, release version, releaseversion_base, 9.1)%</MacroValue>
			<indent type='3'>4</indent>
			<name>Read major/minor release version from ini file</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[Format <Major>.<Minor>, stamped into user doc such as web help.]]></MacroDescr>
			<MacroName>RELEASE_VERSION_README</MacroName>
			<MacroValue>%RELEASE_VERSION_BASE%</MacroValue>
			<indent type='3'>4</indent>
			<name>Set Macro RELEASE_VERSION_README</name>
			<nologging type='11'>-1</nologging>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_VERSION</MacroName>
			<MacroValue>%BUILD_NUMBER%</MacroValue>
			<condcompareto>INTERNAL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<description>%BUILD_VERSION% is passed inas Jenkins environment variable %BUILD_NUMBER%</description>
			<indent type='3'>4</indent>
			<name>Set Build Version from Jenkins BUILD_NUMBER</name>
		</step>
		<step action='Log Message'>
			<Level type='3'>4</Level>
			<Message>Build Type has been set to %BUILD_VERSION%</Message>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Echo Build Number Message</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Third segment of the release version, usually a "patch" number.  A release will have a specific number while Dev work will use the build number mod 1000 (can only be three digitis).</MacroDescr>
			<MacroName>RELEASE_VERSION_THIRDSEGMENT</MacroName>
			<MacroValue>%READ_INI(%RELEASE_VERSION_INI%, release version, releaseversion_thirdsegment,[%BUILD_VERSION%  mod 1000])%</MacroValue>
			<description><![CDATA[If the "Patch" or third segment of the release version is available from the ini file
   use that,
else
     use the build version mod 1000 (must be at most three digits).

In general, a release will have a specific number in the ini file, while a Dev build will use the build number.  Product update logic looks at the first three segments of the version, so this will let Dev/QE update with every build (except when it loops through 1000), while using a release version that makes sense.]]></description>
			<indent type='3'>4</indent>
			<name>Read release version third segment (patch?) from ini file</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[Format <Major>.<Minor>.<Patch>]]></MacroDescr>
			<MacroName>RELEASE_VERSION</MacroName>
			<MacroValue>%RELEASE_VERSION_BASE%.%RELEASE_VERSION_THIRDSEGMENT%</MacroValue>
			<indent type='3'>4</indent>
			<name>Set Macro RELEASE_VERSION</name>
			<nologging type='11'>-1</nologging>
		</step>
		<step action='Set Macro'>
			<MacroName>DoPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoPDBs if Nightly BuildType</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Vault Branding Build</name>
		</step>
		<step action='Set Macro'>
			<MacroName>RELEASE_VERSION</MacroName>
			<MacroType type='3'>1</MacroType>
			<MacroValue>%BRAND_VAULT_VERSION%</MacroValue>
			<condexpr>%BUILD_LABEL%</condexpr>
			<indent type='3'>4</indent>
			<name>Calculate Release Version</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_DATE</MacroName>
			<MacroValue>[vbld_FormatDate()][vbld_FormatTime()]</MacroValue>
			<indent type='3'>3</indent>
			<name>Calculate New Build Date</name>
		</step>
		<step action='Set Macro'>
			<MacroName>FULL_BUILD_NUMBER</MacroName>
			<MacroValue>%RELEASE_VERSION%.%BUILD_VERSION%</MacroValue>
			<indent type='3'>3</indent>
			<name>Calculate full build number</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_LABEL</MacroName>
			<MacroValue>%COMPANY_NAME% %FULL_BUILD_NUMBER%</MacroValue>
			<condexpr>%BUILD_LABEL%</condexpr>
			<description><![CDATA[Build Label calculated from Release & Build Label]]></description>
			<indent type='3'>3</indent>
			<name>Calculate Build Label</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

STARTING BUILD %BUILD_LABEL% AT %BUILD_DATE%

]]></Message>
			<indent type='3'>3</indent>
			<name>Echo Build Number</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>C</ParamValues>
			<ParamValues>1</ParamValues>
			<Parameters array='0'>DISK_DRIVE</Parameters>
			<Parameters>GB_FREE</Parameters>
			<SubName>Check Free Space on Disk</SubName>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Check Free Space on C:\ Drive</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>D</ParamValues>
			<ParamValues>4</ParamValues>
			<Parameters array='0'>DISK_DRIVE</Parameters>
			<Parameters>GB_FREE</Parameters>
			<SubName>Check Free Space on Disk</SubName>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Check Free Space on D:\ Drive</name>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>Completion Phase</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>StartCompletion</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - StartCompletion</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>C:\testing</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by units tests</description>
			<indent type='3'>2</indent>
			<name>Clean C:\testing Directory</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>C:\Deploy-Master</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by Deploy for units tests</description>
			<indent type='3'>2</indent>
			<name>Clean C:\Deploy-Master Directory</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>D:\DC</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by Unit Tests but not needed after run</description>
			<indent type='3'>2</indent>
			<name>Clean D:\DC</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>EndCompletion</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - EndCompletion</name>
		</step></steps>
	<steps type='1'>
		<step action='Group'>
			<name>Deploy Vault Components</name>
		</step>
		<step action='Set Macro'>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroName>%DEPLOY_CONFIG_FILE%-DONE</MacroName>
			<MacroValue>0</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Success Macro = 0</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%</ParamValues>
			<Parameters array='0'>FILE_EXISTS_NAME</Parameters>
			<SubName>File Exists</SubName>
			<description>This helps cater for the optional side-by-side release for AD</description>
			<indent type='3'>1</indent>
			<name>Does Deploy Config File Exists?</name>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%FILE_EXISTS%</condexpr>
			<indent type='3'>1</indent>
			<name>Deploy N/A</name>
		</step>
		<step action='Log Message'>
			<Message>DEPLOY -- %WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE% not available for Deploy</Message>
			<indent type='3'>2</indent>
			<name>Log Message for Deploy Config Not Available</name>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FILE_EXISTS%</condexpr>
			<indent type='3'>1</indent>
			<name>Deploy</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_DB_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Common,DBServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read DB Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_WEB_SERVICES_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,WebServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Web Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_JOB_PROCESSOR_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,JPServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read JP Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_UPDATESERVER_URL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,UpdateServerUrl, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Update Server URL from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_UPDATESERVER_FILELOC</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,UpdateServerFileLocation, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Update Server File Location from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_BLOCK_DATA_DIR</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,BlocksStorageRootFolderUNC,)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read BlockData from deploy config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_JP_SERVICE_NAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,JobProcessor,ServiceName,)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read JP Service Name from deploy config</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[DEPLOY -- %WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%
DEPLOY -- Database server = %DEPLOY_DB_SERVER%
DEPLOY -- WebService server = %DEPLOY_WEB_SERVICES_SERVER%
DEPLOY -- Job Processor server = %DEPLOY_JOB_PROCESSOR_SERVER%
DEPLOY -- UpdateServer url = %DEPLOY_UPDATESERVER_URL%
DEPLOY -- UpdateServer directory = %DEPLOY_UPDATESERVER_FILELOC%
DEPLOY -- Block Data dir = %DEPLOY_BLOCK_DATA_DIR%
DEPLOY -- Job Processor Name = %DEPLOY_JP_SERVICE_NAME%

]]></Message>
			<indent type='3'>2</indent>
			<name>Log Deploy Values</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "net stop %DEPLOY_JP_SERVICE_NAME%", "%DEPLOY_JOB_PROCESSOR_SERVER%", true</Script>
			<indent type='3'>2</indent>
			<name>Stop Old Job Processor</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Backend</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_DB_SERVER%\c$\Deploy-%TF_BRANCH%</DestDir>
			<Ext><![CDATA[\Database\*.*
\DeploymentConfigs\*.*
*.vbs
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files to Database</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\Database.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE% ", "%DEPLOY_DB_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Database</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Frontend</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%DEPLOY_BLOCK_DATA_DIR%</DestDir>
			<Empty type='11'>-1</Empty>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Delete BlockData from filesystem</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_JOB_PROCESSOR_SERVER%\c$\Deploy-%TF_BRANCH%\</DestDir>
			<ExclExt>/FilesDebug</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files to Job Processor</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_WEB_SERVICES_SERVER%\c$\Deploy-%TF_BRANCH%\</DestDir>
			<ExclExt>/FilesDebug</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>%DEPLOY_WEB_SERVICES_SERVER%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%DEPLOY_JOB_PROCESSOR_SERVER%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files for Web Services</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA['Set objNetwork = CreateObject("Wscript.Network")
'strComputer = objNetwork.ComputerName

'Set colAccounts = GetObject("WinNT://" & strComputer & "")
Set colAccounts = GetObject("WinNT://%DEPLOY_WEB_SERVICES_SERVER%")

colAccounts.Filter = Array("user")
For Each objUser In colAccounts

    'If it's a device then delete it
    if StrComp("DC Device: ",Left(objuser.FullName, Len("DC Device: "))) = 0 Then
		WScript.Echo "Deleting device: " & objUser.Name
		colAccounts.delete "user", objUser.Name
    else
		WScript.Echo "Not deleting user account: " & objUser.Name
    End If
Next
]]></Script>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Delete all devices from deployment web server</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\webServices.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE%", "%DEPLOY_WEB_SERVICES_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Webservices</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\jobProcessor.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE%", "%DEPLOY_JOB_PROCESSOR_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Job Processor</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Deploy Datacastle Update Pack for BVT</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<files base=")[[a-zA-Z0-9\/\:\.\_]]+(".+)]]></Find>
			<Replace>($1)%DEPLOY_UPDATESERVER_URL%/%RELEASE_VERSION%.%BUILD_VERSION%($2)</Replace>
			<description>Change Localhost to web</description>
			<indent type='3'>3</indent>
			<name>Update manifest.xml - files base</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileOut>
			<Find><![CDATA[(^.+DeployGroup=)([[A-Za-z0-9\.\-\ \_\\]]+)(</description>$)]]></Find>
			<Replace>$1BVT$3</Replace>
			<description>Change Deploy Group to BVT</description>
			<indent type='3'>3</indent>
			<name>Update manifest.xml - Deploy Group</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%DEPLOY_UPDATESERVER_FILELOC%</DestDir>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<LogUpToDate type='11'>-1</LogUpToDate>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle</SourceDir>
			<TBD type='11'>-1</TBD>
			<description><![CDATA[Will copy version directory & Zip
Replace MasterManifest.xml]]></description>
			<indent type='3'>3</indent>
			<name>Copy Files - Update Pack to Web</name>
		</step>
		<step action='Set Macro'>
			<MacroName>%DEPLOY_CONFIG_FILE%-DONE</MacroName>
			<MacroValue>1</MacroValue>
			<indent type='3'>3</indent>
			<name>Set Deployment Completed Macro = 1</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Master</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<description><![CDATA[Eventually this will deploy the tests on developer machines at the moment it is just deploying them on BOB
The TestRunner will pick them up and run them as needed.]]></description>
			<name>Run Distributed Automated Tests on Master</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\</DestDir>
			<Ext>*.*</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\ATFFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the Test Files - ATF Tests to AutomatedTestFolder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\PartnerTool\</DestDir>
			<Ext>*.*</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\PartnerTool</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the ParterTool to AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\Vault</DestDir>
			<Ext>*.*</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\Vault</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the Vault Files for Vault tests - ATF Tests to AutomatedTestFolder\Vault</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\Installers</DestDir>
			<Ext>DC-%FULL_BUILD_NUMBER%.exe</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy the Installer to the AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\</DestDir>
			<Ext>PublishSettings.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy the PublishSettings to the AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%WebAtfSettings.xml</FileIn>
			<FileOut>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\%MACHINE_NAME%WebAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for NT</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%BOB2AtfSettings.xml</FileIn>
			<FileOut>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\%MACHINE_NAME%BOB2AtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for BOB2</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%VaultAtfSettings.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\..\AutomatedTestFiles\TestMachineSettingsFiles\%MACHINE_NAME%VaultAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for Vault</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%RackspaceAtfSettings.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\..\AutomatedTestFiles\TestMachineSettingsFiles\%MACHINE_NAME%RackspaceAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for Rackspace</name>
		</step>
		<step action='Group'>
			<name>CopyVaultFiles</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<condcompareto>TRUE</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%DEBUG%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Debug</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\JobProcessor</DestDir>
			<ExclExt><![CDATA[*.exclude
*.cs]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\JobProcessorService\bin\Debug</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy Debug-Vault JobProcessor Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\BlockManagementService</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs
*.config
*.xml]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.BlockManagementService\bin\Debug</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy Debug-BlockManagementService Files</name>
		</step>
		<step action='Group'>
			<checked type='11'>0</checked>
			<condcompareto>V1</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Works for all post V1 builds</description>
			<indent type='3'>2</indent>
			<name>Copy Debug Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*.*
\Obj\*\*
\Configuration\*.*
*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[\bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\CustomerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Valut CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\DiscoveryService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
*.exclude
\Configuration\*.*
\obj\*\*
overrides.config
]]></ExclExt>
			<Ext><![CDATA[\bin\*.*
*.asax
*.Config]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.DiscoveryService</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault DiscoveryService Files Bin folder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\ProvisionService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerReportingService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.PartnerReportingService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerReportingService Files</name>
		</step>
		<step action='Group'>
			<checked type='11'>0</checked>
			<condcompareto>Master-V1.2</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Added due to WebService Project change for V2.0</description>
			<indent type='3'>2</indent>
			<name>Copy Debug Files For Master-V1.2  Branch</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\CustomerService</DestDir>
			<ExclExt><![CDATA[*.exclude
]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Valut CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\ProvisionService</DestDir>
			<ExclExt><![CDATA[*.exclude
]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerService</DestDir>
			<ExclExt><![CDATA[*.exclude

]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<condcompareto>Master-V1.2</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerService Files (Master-V1.2)</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>FALSE</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%DEBUG%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Release</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\JobProcessor</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\JobProcessorService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy JobProcessor Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\BlockManagementService</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs
*.config]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy BlockManagementService Files</name>
		</step>
		<step action='Group'>
			<condcompareto>V1</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Works for all post V1 builds</description>
			<indent type='3'>2</indent>
			<name>Copy Release Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\CustomerService</DestDir>
			<ExclExt><![CDATA[*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\ProvisionService</DestDir>
			<ExclExt><![CDATA[*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\PartnerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
Global.asax
Web.config
*.as*
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy PartnerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\DiscoveryService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.DiscoveryService</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy DiscoveryService Files</name>
		</step>
		<step action='Group'>
			<name>Stamp Assembly</name>
		</step>
		<step action='Log Message'>
			<Message>Stamping %ASSEMBLY_SOURCE%</Message>
			<indent type='3'>1</indent>
			<name>Stamping AssemblyInfo.cs</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyFileVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyFileVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyFileVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyInformationalVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyInformationalVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyInformationalVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Append><![CDATA[
[[assembly:AssemblyKeyFileAttribute("%STRONG_NAME_KEY%")]]
[[assembly:AssemblyDelaySignAttribute(true)]]]]></Append>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[AssemblyKeyFileAttributeAlwaysAdd
]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>wont be found</Replace>
			<checked type='11'>0</checked>
			<description><![CDATA[[assembly:AssemblyKeyFileAttribute("myKey.snk")]
[assembly:AssemblyDelaySignAttribute(true)]]]></description>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyKeyFileAttribute - DelaySign on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Append><![CDATA[
[[assembly:AssemblyKeyFileAttribute("%STRONG_NAME_KEY%")]]
]]></Append>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[AssemblyKeyFileAttributeAlwaysAdd
]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>wont be found</Replace>
			<checked type='11'>0</checked>
			<description><![CDATA[[assembly:AssemblyKeyFileAttribute("myKey.snk")]
]]></description>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyKeyFileAttribute on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Group'>
			<name>Update App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_ServiceName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_ServiceName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_DisplayName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_DisplayName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_AccountName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1%SVC_ACCOUNT%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_AccountName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_AccountFullName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2\(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_AccountFullName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_TransportService_ServiceName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>TransportService_ServiceName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_TransportService_DisplayName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>TransportService_DisplayName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Registry_HKLM_ApplicationKey" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>Registry_HKLM_ApplicationKey</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_ApplicationName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_TitleBarName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_MutexName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%CLIENT_MUTEX%$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_MutexName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>Notifier_ApplicationName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_MutexName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%NOTIFIER_MUTEX%$3</Replace>
			<indent type='3'>1</indent>
			<name>Notifier_MutexName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Miscellaneous_BITSJobNamePrefix" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%UNIQUE_SYSTEM_NAME%_$2$3</Replace>
			<indent type='3'>1</indent>
			<name>Miscellaneous_BITSJobNamePrefix</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Miscellaneous_DatapathFolderName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>Miscellaneous_DatapathFolderName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_MainServiceRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%MAIN_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - MainServiceRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_TransportServiceRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%TRANSPORT_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - TransportServiceRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_NotifierRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%NOTIFIER_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - NotifierRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_ClientRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%CLIENT_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - ClientRemotingUri</name>
		</step>
		<step action='Group'>
			<description>Checks a nominated drive to report free space</description>
			<name>Check Free Space on Disk</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Set objWMIService = GetObject("winmgmts:")
Set objLogicalDisk = objWMIService.Get("Win32_LogicalDisk.DeviceID='%DISK_DRIVE%:'")

iSpc= objLogicalDisk.FreeSpace/1000
iSpc= iSpc/1000
iSpc= iSpc/1000
iSpc= FormatNumber(iSpc,1)

'To capture the Date & Time, use "Now" function instead of "Date"
Wscript.Echo " %DISK_DRIVE%: " & iSpc & " GB Free space or " & objLogicalDisk.FreeSpace

Project.Macros.Add "FREE_SPACE_GB", iSpc

If iSpc < %GB_FREE% Then
	Wscript.Echo "Free space alert - LOW DISK SPACE"
	Project.Macros.Add "FREE_SPACE_ALERT", 1
ELSE
	Project.Macros.Add "FREE_SPACE_ALERT", 0
End If
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Free Disk Space</name>
		</step>
		<step action='Exit'>
			<Message>Disk Space is low.</Message>
			<Status type='3'>1</Status>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FREE_SPACE_ALERT%</condexpr>
			<indent type='3'>1</indent>
			<name>Exit</name>
		</step>
		<step action='Group'>
			<name>Check Strong Naming</name>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.BackupService.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.BackupTransportService.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ClientTool.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.Common.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.FileStore.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.Notifier.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ServiceLibrary.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ServiceSchemas.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.Bits.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.Common.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.DTOSchemas.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<name>Build Branded Setup</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\Src\Branding\%BRAND_NAME%\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy Files Themes (Not Carbonite)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<Ext>theme.xml</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\ClientTool\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy theme.xml to branded releases (Not Carbonite)</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\ReadMe.rtf</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\ReadMe.rtf</FileOut>
			<Find>@INSTALLER_BRAND_NAME@</Find>
			<Literal type='11'>-1</Literal>
			<Replace>%INSTALLER_BRAND_NAME%</Replace>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Update @INSTALLER_BRAND_NAME@ token in ReadMe.rtf</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\InstallationReadMe.rtf</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\InstallationReadMe.rtf</FileOut>
			<Find>[Datacastle]</Find>
			<Literal type='11'>-1</Literal>
			<Replace>%INSTALLER_BRAND_NAME%</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>1</indent>
			<name>Update [Datacastle] token in InstallationReadMe.rtf</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\Src\Branding\%BRAND_NAME%\Install</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy install rtf files from brand (Not Carbonite)</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme\Icons\Application.ico" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme\Icons\App_%FULL_BUILD_NUMBER%.ico" </command>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Copy the Application.Ico to App_%FULL_BUILD_NUMBER%.ico</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<ExclExt>/unused_items</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\ClientTool\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Copy Files Themes (Carbonite only)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext><![CDATA[Datacastle.Client.ClientTool.exe
Datacastle.Client.Notifier.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles-PostSigning\SetupAssemblies\</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[If %BRAND_SIGNED_FLAG% set to True grab the Signed Client Tool & Notifier]]></description>
			<indent type='3'>1</indent>
			<name>Copy Signed Client Tool Files to Deployment Layout</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext><![CDATA[Datacastle.Client.ClientTool.exe
Datacastle.Client.Notifier.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFilesForSigning-PreSigning\SetupAssemblies</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[If %BRAND_SIGNED_FLAG% not set to True grab the Signed Client Tool & Notifier]]></description>
			<indent type='3'>1</indent>
			<name>Copy unsigned Client Tool Files to Deployment Layout</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="AppUpdate_SetupComplete" value=")(\w+)(" />$)
]]></Find>
			<Replace>($1)true($3)\r\n</Replace>
			<indent type='3'>1</indent>
			<name>Update AppUpdate_SetupComplete = true</name>
		</step>
		<step action='Group'>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Make updates for branding build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Transport Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Transport Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Transport Service App Config</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_NAME%</ValueData>
			<ValueName>BRANDNAME</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Name in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_CORP_NAME%</ValueData>
			<ValueName>BRANDCORPNAME</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Corp Name in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_INFO_URL%</ValueData>
			<ValueName>BRANDINFOURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Info Url in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_SUPPORT_URL%</ValueData>
			<ValueName>BRANDSUPPORTURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Support Url in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_UPDATE_URL%</ValueData>
			<ValueName>BRANDUPDATEURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Update Url in MSIFactory INI</name>
		</step>
		<step action='InstallAWARE'>
			<BuildType type='3'>1</BuildType>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Datacastle.ClientTool.Setup.mpr</Filename>
			<RevCode type='11'>-1</RevCode>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<indent type='3'>1</indent>
			<name>Build Client Setup - InstallAware (release)</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Release\Single\Datacastle.ClientTool.Setup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>1</indent>
			<name>Sign InstallerAware Setup</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Wscript.Echo "Building for %BRAND_NAME%"

if "%BRAND_SIGNED_FLAG%" = "True" Then
		wscript.Echo "Building branded release Signed Release with Signed Exes & Installer - %WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.exe"
		Project.Macros.Add "SETUP_NAME", "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.exe"
ELSE
		wscript.Echo "Building Standard unsigned Release with Signed Exes & Installer - %WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-Unsigned.exe"
		Project.Macros.Add "SETUP_NAME", "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-Unsigned.exe"
End If

Wscript.Echo "Building %SETUP_NAME%"
]]></Script>
			<checked type='11'>0</checked>
			<description><![CDATA[Do not change order of BRAND.INI this happens to snure all brands will be signed
]]></description>
			<indent type='3'>1</indent>
			<name>Determine setup exe name</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Release\Single\Datacastle.ClientTool.Setup.exe" %SETUP_NAME%</command>
			<indent type='3'>1</indent>
			<name>Copy InstallerAware Setup exe</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%FULL_BUILD_NUMBER%</ValueData>
			<ValueName>BUILDNUM</ValueName>
			<indent type='3'>1</indent>
			<name>Update Build number in MSIFactory INI</name>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_MSIPASSPHRASE%</condexpr>
			<indent type='3'>1</indent>
			<name>MSIFactory Installer (if MSIPASSPHRASE = True)</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Desktop\temp</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Replace source location in msifact file</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Documents\MSI Factory\Projects\FinalizeInstall.lua</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\FinalizeInstall.lua</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Replace location of lua companion file</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext>autoconfig.xml</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SkipExist type='11'>-1</SkipExist>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy autoconfig.xml to client dir</name>
		</step>
		<step action='Write XML'>
			<Create type='11'>-1</Create>
			<Filename>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%BRAND_ACTIVATIONURL%</Text>
			<XPath>/AutoConfig/ActivationUrl</XPath>
			<condcompareto>NOURL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_ACTIVATIONURL%</condexpr>
			<indent type='3'>2</indent>
			<name>Write branded URL</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileOut>
			<Find><![CDATA[><]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[>
<]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Fix xml formatting</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"C:\Program Files\MSI Factory\MSI Factory.exe" /build "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact" "/STDOUT" "/VARS:%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini"</command>
			<condcompareto>0</condcompareto>
			<condexpr>%BRAND_LOOP_COUNT%</condexpr>
			<indent type='3'>2</indent>
			<name>Call MSIFactory to build MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.msi"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.MSI" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.MSI"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-MSI.EXE"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_MSINOPASSPHRASE%</condexpr>
			<indent type='3'>1</indent>
			<name>MSIFactory Installer (if MSINoPassphrase = True)</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Desktop\temp</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Replace>
			<indent type='3'>2</indent>
			<name>Replace source location in msifact file</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Documents\MSI Factory\Projects\FinalizeInstall.lua</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\FinalizeInstall.lua</Replace>
			<indent type='3'>2</indent>
			<name>Replace location of lua companion file</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\NoPassphrase-autoconfig.xml" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml"</command>
			<indent type='3'>2</indent>
			<name>Copy NoPassphrase-autoconfig.xml</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write XML'>
			<Create type='11'>-1</Create>
			<Filename>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%BRAND_ACTIVATIONURL%</Text>
			<XPath>/AutoConfig/ActivationUrl</XPath>
			<condcompareto>NOURL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_ACTIVATIONURL%</condexpr>
			<indent type='3'>2</indent>
			<name>Write branded URL</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileOut>
			<Find><![CDATA[><]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[>
<]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Fix xml formatting</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"C:\Program Files\MSI Factory\MSI Factory.exe" /build "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact" "/STDOUT" "/VARS:%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini"</command>
			<condcompareto>0</condcompareto>
			<condexpr>%BRAND_LOOP_COUNT%</condexpr>
			<indent type='3'>2</indent>
			<name>Call MSIFactory to build MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.msi"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.MSI" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.MSI"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-MSI.EXE"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<description>used for datacastle updater</description>
			<indent type='3'>1</indent>
			<name>Create Update Zip</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[dim GuidMaker
dim NewGuid

Set GuidMaker = CreateObject("GuidMakr.GUID")
NewGuid = guidMaker.GetGUID()

wscript.Echo newguid

If Len(newguid) < 2 Then
	wscript.Stop
else
	NewGuid = Left(newguid, len(newguid) - 1)
	NewGuid = Right(newguid, len(newguid) - 1)
End If

wscript.Echo "Labeling the manifest with guid: " & newguid

Project.Macros.Add "UPDATER_GUID", newguid
]]></Script>
			<indent type='3'>2</indent>
			<name>Generate Manifest GUID</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[dim GuidMaker
dim NewGuid

Set GuidMaker = CreateObject("GuidMakr.GUID")
NewGuid = guidMaker.GetGUID()

wscript.Echo newguid

If Len(newguid) < 2 Then
	wscript.Stop
else
	NewGuid = Left(newguid, len(newguid) - 1)
	NewGuid = Right(newguid, len(newguid) - 1)
End If

wscript.Echo "Labeling the master manifest with guid: " & newguid

Project.Macros.Add "UPDATER_GUID_MASTER", newguid
]]></Script>
			<indent type='3'>2</indent>
			<name>Generate Master Manifest GUID</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="AppUpdate_SetupComplete" value=")(\w+)(" />$)
]]></Find>
			<Replace>($1)false($3)\r\n</Replace>
			<indent type='3'>2</indent>
			<name>Update AppUpdate_SetupComplete</name>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<indent type='3'>2</indent>
			<name>Create Signed Manual Update Pack</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\ManualClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<ExclExt><![CDATA[\Client Tool\Theme\*.*
\Logging\*.*
\Tools\*.*
\Client Tool\*.config
\Services\Backup Service\*.config
\Services\Backup Transport Service\*.config
*.rtf]]></ExclExt>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Source>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>3</indent>
			<name>Create Manual updater pack zip file</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Source>
			<indent type='3'>2</indent>
			<name>Create updater zip file</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Add .Net 3.5 checker to update packs</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles\Framework35CheckAndInstall.exe" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles\UpgradeDependencies.EXE"</command>
			<indent type='3'>3</indent>
			<name>Rename .Net 3.5 checker/installer to update pack bootstrapper well known EXE name</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<Ext>UpgradeDependencies*.EXE</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles</Source>
			<indent type='3'>3</indent>
			<name>Add to updater zip file</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<description>Version=)([[\d\.]]+)(:.+$)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - Description Version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find>(^\s+manifestId=")([[a-zA-Z0-9\-]]+)(".+$)</Find>
			<Replace>($1)%UPDATER_GUID%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - Manifest ID</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<files base="[[\w\:\/]]+Datacastle/)1.0.0.0(".+)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - files base</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<file source=")[[\w\.]]+(".+)]]></Find>
			<Replace>($1)ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - files source</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Private Function GetFileSizeMB(Filename)
    Dim Size
    Dim FSize
    Dim fs

    Set fs = CreateObject("Scripting.FileSystemObject")
    Set fsfile = fs.GetFile(filename)
    Size = fsfile.Size

    If Size = "" Then
        Exit Function
    End If

    FSize = ((Size / (1024)) / 1024)
    GetFileSizeMB = Round(FSize, 2)
End Function

Dim FileSizeMB

filesizemb = GetFileSizeMB("%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip")

wscript.Echo "update zip is " & filesizemb & "MB"

Project.Macros.Add "UpdateZipSizeMB", filesizemb
]]></Script>
			<indent type='3'>2</indent>
			<name>Set variable - UpdateZipSizeMB</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find>(^.+DownloadSize=)[[\d\.]]+(MB:.+)</Find>
			<Replace>($1)%UpdateZipSizeMB%($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - file size</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileOut>
			<Find><![CDATA[(^\s+<manifest location=")[[\d\.]]+(/manifest.xml" manifestId=")[[\w\-]]+(" />)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($2)%UPDATER_GUID%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update Mastermanifest.xml - include manifest</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileOut>
			<Find><![CDATA[(^\s+<description>)([[\d\.]]+)(</description>$)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update Mastermanifest.xml - Description Version</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%</DestDir>
			<Ext>mastermanifest.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy Files - Mastermanifest</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%</DestDir>
			<Ext>manifest.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy Files - manifest</name>
		</step>
		<step action='Group'>
			<name>File Exists</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Dim fs
Set fs = CreateObject("Scripting.FileSystemObject")

If fs.FileExists("%FILE_EXISTS_NAME%") Then
	Wscript.Echo "File Exists - %FILE_EXISTS_NAME%"
	Project.Macros.Add "FILE_EXISTS", 1
ELSE
	Wscript.Echo "File DOES NOT Exist - %FILE_EXISTS_NAME%"
	Project.Macros.Add "FILE_EXISTS", 0
End If
]]></Script>
			<indent type='3'>1</indent>
			<name>Does File Exists</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>Log Major Build Stage</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

%DATETIME%: ---------- MAJOR BUILD STAGE LOG: %BUILD_STAGE%]]></Message>
			<indent type='3'>1</indent>
			<name>Log Message</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, %TIMER_MINOR_STAGE%, [Int(Timer() - %TIMER_MINOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MINOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Minor Timing data to  File</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, Total, [int(Timer() - %TIMER_MAJOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MAJOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Major Timing data to  File</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Start timer so we can write out timing data once this stage is done</MacroDescr>
			<MacroName>TIMER_MAJOR</MacroName>
			<MacroValue>"[Timer()]"</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Major Timer</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Store the current stage so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MAJOR_STAGE</MacroName>
			<MacroValue>%BUILD_STAGE%</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Major Timer Stage</name>
		</step>
		<step action='Set Macro'>
			<Category>Temporary</Category>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroDescr>Store the current seconds since midnight so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MINOR</MacroName>
			<indent type='3'>1</indent>
			<name>Clear Minor Timer</name>
		</step>
		<step action='Set Macro'>
			<Category>Temporary</Category>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroName>TIMER_MINOR_STAGE</MacroName>
			<indent type='3'>1</indent>
			<name>Clear Minor Timer Stage</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>Log Minor Build Stage</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[
%DATETIME%: ----- MINOR BUILD STAGE LOG: %BUILD_STAGE%]]></Message>
			<indent type='3'>1</indent>
			<name>Log Message</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, %TIMER_MINOR_STAGE%, [Int(Timer() - %TIMER_MINOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MINOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Minor Timing data to  File</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Start timer so we can write out timing data once this stage is done</MacroDescr>
			<MacroName>TIMER_MINOR</MacroName>
			<MacroValue>"[Timer()]"</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Minor Timer</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Store the current stage so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MINOR_STAGE</MacroName>
			<MacroValue>%BUILD_STAGE%</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Minor Timer Stage</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>BuildLocalizedMSI</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandSupportsMultipleLocales%</condexpr>
			<indent type='3'>1</indent>
			<name>If this brand is localized</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.msi
*.mst]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Delete MSI/MSTs from loc working folder</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c move "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\en-us\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1033.msi"</command>
			<indent type='3'>2</indent>
			<name>Move EN-US MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesGerman%</condexpr>
			<indent type='3'>2</indent>
			<name>If German prepare the German MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\de-de\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1031.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy DE-DE MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1031.msi 1031.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for German to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1031.mst 1031</command>
			<indent type='3'>3</indent>
			<name>Merge German MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesFrench%</condexpr>
			<indent type='3'>2</indent>
			<name>If French prepare the French MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\fr-fr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1036.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy FR-FR MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1036.msi 1036.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for French to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1036.mst 1036</command>
			<indent type='3'>3</indent>
			<name>Merge French MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesSpanish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Spanish prepare the Spanish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\es-es\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\3082.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy ES-ES MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 3082.msi 3082.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Spanish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 3082.mst 3082</command>
			<indent type='3'>3</indent>
			<name>Merge Spanish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesItalian%</condexpr>
			<indent type='3'>2</indent>
			<name>If Italian prepare the Italian MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\it-it\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1040.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy IT-IT MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1040.msi 1040.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Italian to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1040.mst 1040</command>
			<indent type='3'>3</indent>
			<name>Merge Italian MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesPolish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Polish prepare the Polish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\pl-pl\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1045.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy pl-pl MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1045.msi 1045.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Polish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1045.mst 1045</command>
			<indent type='3'>3</indent>
			<name>Merge Polish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesJapanese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Japanese prepare the Japanese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\ja-jp\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1041.msi"</command>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>3</indent>
			<name>Copy ja-jp MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1041.msi 1041.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Japanese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1041.mst 1041</command>
			<indent type='3'>3</indent>
			<name>Merge Japanese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesKorean%</condexpr>
			<indent type='3'>2</indent>
			<name>If Korean prepare the Korean MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\ko-kr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1042.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy ko-kr MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1042.msi 1042.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Korean to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1042.mst 1042</command>
			<indent type='3'>3</indent>
			<name>Merge Korean MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesPortuguese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Portuguese prepare the Portuguese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\pt-br\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1046.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy pt-br MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1046.msi 1046.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Portuguese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1046.mst 1046</command>
			<indent type='3'>3</indent>
			<name>Merge Portuguese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesChinese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Chinese prepare the Chinese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\zh-cn\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\2052.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy zh-cn MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 2052.msi 2052.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Chinese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 2052.mst 2052</command>
			<indent type='3'>3</indent>
			<name>Merge Chinese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesTurkish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Turkish prepare the Turkish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\tr-tr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1055.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy tr-tr MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1055.msi 1055.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Turkish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1055.mst 1055</command>
			<indent type='3'>3</indent>
			<name>Merge Turkish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c cscript /B WiLangId.vbs 1033.msi Package %BRAND_LocLCIDs%</command>
			<indent type='3'>2</indent>
			<name>Set the languages available in the resultant MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1033.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\en-us\DCProtect.msi" </command>
			<indent type='3'>2</indent>
			<name>Copy the result from loc working folder back to where installer came from in DCProtect output</name>
			<outputfrom type='3'>1</outputfrom>
		</step></steps>
	<steps type='2'>
		<step action='Group'>
			<name>Exit</name>
		</step>
		<step action='Write File'>
			<Filename>Failure.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write summary log to BuildOutput</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c move %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Exit'>
			<Status type='3'>1</Status>
			<indent type='3'>1</indent>
			<name>Exit</name>
		</step>
		<step action='Group'>
			<name>Report Unit Test Error</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write File'>
			<Filename>%BUILDOUTPUTDIR_ALL%\TestResults\Result-Summary_%FULL_BUILD_NUMBER%.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<indent type='3'>1</indent>
			<name>Write File</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Dim fso
Dim file
Dim line
Dim FailedTests
Const TestResults = "%BUILDOUTPUTDIR_ALL%\TestResults\Result-Summary_%FULL_BUILD_NUMBER%.txt"

Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile(TestResults, 1, False)

Do Until file.AtEndOfStream
	line = file.ReadLine
	If Left(line, Len("Failed")) = "Failed" Then
		FailedTests = FailedTests + line + vbcrlf
	End If
Loop


wscript.Echo "Failed Tests are: " & vbcrlf & FailedTests

if FailedTests = "" Then
	wscript.Echo "No tests actually failed"
	Set objMacro = vbld_TempMacros.Add("SEND_FAILED_MAIL", "false")
	vbld_AllMacros.Item("UNIT_TESTS_FAILED").Value = "false"
else
	wscript.Echo "Tests actually failed"
	vbld_TempMacros.add "FailedUnitTests", FailedTests, "", "", false
	Set objMacro = vbld_TempMacros.Add("SEND_FAILED_MAIL", "true")
	vbld_AllMacros.Item("UNIT_TESTS_FAILED").Value = "true"
end if

wscript.Echo "Send Mail: " & vbld_AllMacros.Item("SEND_FAILED_MAIL").Value]]></Script>
			<indent type='3'>1</indent>
			<name><![CDATA[Get Failed & Errored Tests]]></name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy %LOGFILE% %LOGFILE%_failed_%RELEASE_VERSION%.%BUILD_VERSION%.%BUILD_DATE%.txt</command>
			<indent type='3'>1</indent>
			<name>Backup Failed Build Log</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<name>Report Build of Tests Failure</name>
		</step>
		<step action='Write File'>
			<Filename>%BUILDOUTPUTDIR_ALL%\Failure_%BUILD_LABEL%.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<checked type='11'>0</checked>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write summary log to BuildOutput</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c move %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step></steps>
	<macros>
		<macro name='1.0.1.1800'>
			<value>0.1.1800</value>
		</macro>
		<macro name='BRAND_INI'>
			<description>This file keeps track of all Branded releases</description>
			<value>%WORKING_DIRECTORY%\WIP\src\Branding\brand.ini</value>
		</macro>
		<macro name='BRAND_INI_VNEXT'>
			<description>This file keeps track of all Branded releases</description>
			<value>%WORKING_DIRECTORY%\Deployment\Client\Branding\brand.ini</value>
		</macro>
		<macro name='BRAND_LOOP_COUNT'>
			<description>Allows iterations through the ini file</description>
			<value>0</value>
		</macro>
		<macro name='BRAND_LOOP_UBOUND'>
			<description>Number of brands found in the ini files</description>
			<value>0</value>
		</macro>
		<macro name='BRAND_NAME'>
			<description>Brand name found in the ini file</description>
			<value>0</value>
		</macro>
		<macro name='BUILD_DEPENDENCIES'>
			<value>D:\Datacastle\Build\BuildDependencies</value>
		</macro>
		<macro name='BUILD_DEPLOYMENTCONFIG'>
			<value>FremontBob.Config</value>
		</macro>
		<macro name='BUILD_DIRECTORY'>
			<value>%WORKING_DIRECTORY%\Build</value>
		</macro>
		<macro name='BUILD_LOGS'>
			<description>Location to keep copies of old buildlogs in</description>
			<value>buildlogs</value>
		</macro>
		<macro name='BUILD_TYPE'>
		</macro>
		<macro name='BUILD_WORKING'>
			<value>%PROJDIR%\util</value>
		</macro>
		<macro name='BUILDOUTPUT_BASE'>
			<value>%WORKING_DIRECTORY%\BuildOutput</value>
		</macro>
		<macro name='BUILDOUTPUT_PRIVATE'>
			<value>%BUILDOUTPUT_BASE%\Private</value>
		</macro>
		<macro name='BUILDOUTPUT_PUBLIC'>
			<value>%BUILDOUTPUT_BASE%\Public</value>
		</macro>
		<macro name='COMPANY_NAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='COPYRIGHT'>
			<value>Copyright  2005-2019</value>
		</macro>
		<macro name='DB_PASSWORD'>
			<value>Mon0r4iL</value>
		</macro>
		<macro name='DB_SERVER'>
			<value>APP</value>
		</macro>
		<macro name='DB_USERNAME'>
			<value>dba</value>
		</macro>
		<macro name='DCDB'>
			<description>Name of the database to use for install</description>
			<value>DCTest</value>
		</macro>
		<macro name='DCPASSWD'>
			<value>1234567890</value>
		</macro>
		<macro name='DCUSER'>
			<value>DEVTEST\DCIIS</value>
		</macro>
		<macro name='DEPLOY'>
			<description>Used to kick off "Deploy Vault to test environment (Nightly only) "</description>
			<value>false</value>
		</macro>
		<macro name='DEPLOY_CONFIG'>
			<description><![CDATA[Deployment Config required for deployment of the vault
]]></description>
			<value>FremontBOB</value>
		</macro>
		<macro name='DEPLOY_DIR'>
			<description>NOT EVERYTHING USES THIS YET! The directory to deploy the applications to (on the server)</description>
			<value>c:\datacastle</value>
		</macro>
		<macro name='DEPLOY_INSTALL_ROOT'>
			<value>D:\Datacastle\DEPLOYMENT\</value>
		</macro>
		<macro name='DEPLOY_PASSWORD'>
			<description>Password for the DEPLOY_USER account</description>
			<value>DcBUil4</value>
		</macro>
		<macro name='DEPLOY_SERVER'>
			<description>Name of the server to deploy</description>
			<value>WEB</value>
		</macro>
		<macro name='DEPLOY_USER'>
			<description>Administrator level account on deploy machine, required for deploy</description>
			<value>DCBUILD</value>
		</macro>
		<macro name='DNGuardFolder'>
			<value>C:\Program Files (x86)\DNGuard EnterpriseV380</value>
		</macro>
		<macro name='DOMAIN_NAME'>
			<value>devtest.local</value>
		</macro>
		<macro name='DOTFUSCATOR_FOLDER'>
			<value>C:\Program Files (x86)\PreEmptive Solutions\Dotfuscator Professional Edition 4.33.0</value>
		</macro>
		<macro name='DOTFUSCATOR_VAULT_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DotfuscatorObfuscateSettings.ini</value>
		</macro>
		<macro name='FILE_EXISTS'>
			<value>1</value>
		</macro>
		<macro name='FREE_SPACE_ALERT'>
			<value>0</value>
		</macro>
		<macro name='FREE_SPACE_GB'>
			<value>91.5</value>
		</macro>
		<macro name='INSTALLER_BRAND_CORP_NAME_DEFAULT'>
			<value>Carbonite Corporation</value>
		</macro>
		<macro name='INSTALLER_BRAND_INFO_URL_DEFAULT'>
			<value>www.carbonite.com</value>
		</macro>
		<macro name='INSTALLER_BRAND_NAME_DEFAULT'>
			<value>Carbonite</value>
		</macro>
		<macro name='INSTALLER_BRAND_SUPPORT_URL_DEFAULT'>
			<value>https://support.carbonite.com/endpoint</value>
		</macro>
		<macro name='INSTALLER_BRAND_UPDATE_URL_DEFAULT'>
			<value>https://support.carbonite.com/endpoint</value>
		</macro>
		<macro name='INSTALLER_MANUFACTURER'>
			<value>Carbonite Corporation</value>
		</macro>
		<macro name='INSTALLER_PRODUCT_CODE'>
			<value>{59560D4E-2CEF-446B-A070-B355B1332C99}</value>
		</macro>
		<macro name='INSTALLER_PRODUCTNAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='INSTALLER_REGISTRY'>
			<value>Software\\Datacastle</value>
		</macro>
		<macro name='INSTALLER_REVISION_CODE'>
			<value>{5DDC5742-E0A3-4D24-B0B8-82E4D489957B}</value>
		</macro>
		<macro name='INSTALLER_UPGRADECODE'>
			<value>{DFF9D5AC-C4B0-47CA-B99F-F1BF06014751}</value>
		</macro>
		<macro name='INTERNAL'>
			<value>FALSE</value>
		</macro>
		<macro name='LOGFILE'>
			<value>%PROJDIR%\%PROJROOT%.log</value>
		</macro>
		<macro name='MACBUILD'>
			<value>172.30.19.95</value>
		</macro>
		<macro name='MAIL_SERVER'>
			<description>was mx1.123together.com</description>
			<value>datacastlecorp-com.mail.eo.outlook.com</value>
		</macro>
		<macro name='MAPDIR'>
			<description>Stores Xenocode's mapping file for each build</description>
			<value>%WORKING_DIRECTORY%\buildMaps</value>
		</macro>
		<macro name='MSI_PRODUCTVERSION'>
			<value>3.2.4047</value>
		</macro>
		<macro name='PRODUCT_CODE'>
			<value>{6F683814-7AA0-4456-92BA-DF74FA0CE749}</value>
		</macro>
		<macro name='PRODUCT_NAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='PROGFILES'>
			<value>C:\Program Files (x86)</value>
		</macro>
		<macro name='QuickCache_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheProductionTemplateConfig\DNGuardObfuscateSettings.ini</value>
		</macro>
		<macro name='RELEASE_VERSION_INI'>
			<value>%PROJDIR%\version.ini</value>
		</macro>
		<macro name='ResetServer_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\ResetServerProductionTemplateConfig\DNGuardObfuscateSettings.ini</value>
		</macro>
		<macro name='REVISION_CODE'>
			<value>{C306637E-32C0-4728-9938-149A25CD2D24}</value>
		</macro>
		<macro name='RUN_ATF_TESTS'>
			<description>Set this to run for ATF tests</description>
			<value>FALSE</value>
		</macro>
		<macro name='RUN_AUTOMATED_TESTS'>
			<description>Used to Run Automated Tests (Nightly)</description>
			<value>false</value>
		</macro>
		<macro name='RUN_UNIT_TESTS'>
			<description>Used to Run Unit Tests</description>
			<value>true</value>
		</macro>
		<macro name='RUN_UNIT_TESTS_OBFUSCATED'>
			<description>Used to Run Obfuscated Unit Tests</description>
			<value>false</value>
		</macro>
		<macro name='SEND_MAIL'>
			<value>FALSE</value>
		</macro>
		<macro name='SETUP_NAME'>
			<value>D:\Datacastle\build\Master\DeploymentFiles\DC-2.0.3.2815-Debug.exe</value>
		</macro>
		<macro name='SIGN_DIR'>
			<value>%PROJDIR%</value>
		</macro>
		<macro name='STRONG_NAME_KEY'>
			<value>\\..\\..\\..\\Datacastle\\StrongName\\DCStrongNameKey.snk</value>
		</macro>
		<macro name='TEMP'>
			<envvar type='11'>-1</envvar>
			<value>%WORKING_DIRECTORY%\TEMP</value>
		</macro>
		<macro name='TEST_TYPE'>
			<value>MINIMUM</value>
		</macro>
		<macro name='TF_BRANCH'>
			<description>Name of TFS Branch the code resides (Default Master)</description>
			<value>Main</value>
		</macro>
		<macro name='TF_PROJECT'>
			<description>Name of TFS Project the code resides</description>
			<value>Datacastle</value>
		</macro>
		<macro name='TF_SERVER'>
			<description>Name of Team Foundation Server</description>
			<value>Mocha</value>
		</macro>
		<macro name='TIMER_DATA'>
			<value>%WORKING_DIRECTORY%\build_times.csv</value>
		</macro>
		<macro name='TMP'>
			<envvar type='11'>-1</envvar>
			<value>%TEMP%</value>
		</macro>
		<macro name='tmp_ChangeSet'>
			<description><![CDATA[e.g.
Backup Performance Test;joed]]></description>
			<value>change set name goes here;user-that-submitted-changset</value>
		</macro>
		<macro name='UNIT_TESTS_FAILED'>
			<value>false</value>
		</macro>
		<macro name='UPDATER_GUID'>
			<value>1021BE14-8D7F-47BC-ABD8-0F0A2317FDB7</value>
		</macro>
		<macro name='UPDATER_GUID_MASTER'>
			<value>599EBC47-2D62-4906-8F24-93B023B97E0C</value>
		</macro>
		<macro name='UpdateZipSizeMB'>
			<value>13.16</value>
		</macro>
		<macro name='WEB_NAME'>
			<value>DCTEST</value>
		</macro>
		<macro name='WORKING_DIRECTORY'>
			<value>%PROJDIR%\..</value>
		</macro></macros>
	<script language='VBScript'><![CDATA[Option Explicit

'-------------------------------------------------------------------------------
' Returns a list of the files (not the folders!) under the specified folder
'-------------------------------------------------------------------------------
Public Function GetFilesRecursively(directory, files())
    ReDim files(0) 'Empty the contents of the current files array
    GetFilesRecursively = GetFilesAndFoldersRecursively(directory, files, 0, True)
End Function

'-------------------------------------------------------------------------------
' Returns the FileSystemObject GetFileName() for the given filename
' Note: Used to clean & verify filename
'-------------------------------------------------------------------------------
Public Function GetFileName(filename)
    Dim fs
    Set fs = CreateObject("Scripting.FileSystemObject")
	GetFileName = fs.GetFileName(filename)
End Function

'-------------------------------------------------------------------------------
' Returns true is the specified folder exists
'-------------------------------------------------------------------------------
Public Function DoesFolderExist(folder)
    Dim fs
    Set fs = CreateObject("Scripting.FileSystemObject")
    DoesFolderExist = fs.FolderExists(folder)
End Function

'-------------------------------------------------------------------------------
' Recursively retrieves a list of all Files and Folders
'-------------------------------------------------------------------------------
Public Function GetFilesAndFoldersRecursively(rootFolder, fileList(), numberFiles, filesOnly)

    Dim fso, folder, folders
    Dim files, file, subfolder

    Set fso = CreateObject("Scripting.FileSystemObject")

    If Right(rootFolder, 1) <> "\" Then
        rootFolder = rootFolder & "\"
    End If

    If Not DoesFolderExist(rootFolder) Then
        GetFilesAndFoldersRecursively = -1
        Exit Function
    End If

    Set folder = fso.GetFolder(rootFolder)

    'Get the list of files in the folder
    Set files = folder.files
    For Each file In files
        ReDim Preserve fileList(numberFiles)
        fileList(numberFiles) = rootFolder & file.Name 'add the file to the array
        numberFiles = numberFiles + 1
    Next

    'Get the folder's subfolders
    Set folders = folder.SubFolders
    For Each subfolder In folders
        If Not filesOnly Then
            ReDim Preserve fileList(numberFiles)
            fileList(numberFiles) = rootFolder & subfolder.Name & "\" 'add the file to the array
            numberFiles = numberFiles + 1
        End If
        GetFilesAndFoldersRecursively (rootFolder & subfolder.Name), fileList, numberFiles, filesOnly
    Next

    GetFilesAndFoldersRecursively = numberFiles
End Function

'----------------------------------------------------------------------------------------------------
' Surrounds a given file name with quotation marks
'----------------------------------------------------------------------------------------------------
Public Function QuoteFileName(filename)
	QuoteFileName = """" & filename & """"
End Function

'----------------------------------------------------------------------------------------------------
' Create all levels of specificed directory path
'----------------------------------------------------------------------------------------------------
Public Sub CreatePath(path)
	Dim folders, tempPath, index, startIndex
	'Strip off trailing backslash
	If Right(path, 1) = "\" Then
		path = Left(path, len(path) - 1)
	End If
	'Split path into tokens for each drive/share and folder
	folders = Split(path, "\", -1, vbTextCompare)
	'Handle UNC paths differently to local ones.
	If Left(path, 2) = "\\" Then
		'If path is UNC, then begin creation following the server and share tokens.
		startIndex = LBOUND(folders) + 4
		If startIndex > UBOUND(folders) Then
			'Path does not specify any folders beneath the UNC share level.
			Exit Sub
		End If
		tempPath = "\\" & folders(LBOUND(folders) + 2) & "\" & folders(LBOUND(folders) + 3) & "\"
	Else
		'If path is local, then begin creation following the drive designator.
		startIndex = LBOUND(folders) + 1
		If startIndex > UBOUND(folders) Then
			'Path does not specify any folders beneath the drive level.
			Exit Sub
		End If
		tempPath = folders(LBOUND(folders)) & "\"
	End If
	'Loop through remaining tokens (all folders) and ensure they exist.
	For index = startIndex to UBOUND(folders)
		tempPath = vbld_FSO.BuildPath(tempPath, folders(index))
		If Not (vbld_FSO.FolderExists(tempPath)) Then
			Call vbld_FSO.CreateFolder(tempPath)
			Builder.LogMessage("Created Folder: " & tempPath)
		End If
	Next
End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Sub SaveProjectStatus()
	' Ensure that the file is not read-only
	Call vbld_MakeFileWriteable(Project.Name)
	' The build failed; Save the project with status so it will continue from the failure step during the next build
	Call Project.Save(Project.Name, vbldSaveStatusInclude)
	' Log a message to indicate that the save happened
	Call Builder.LogMessage("Failed Build: Project saved with status")
End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Sub ClearProjectStatus()
	' Ensure that the file is not read-only
	Call vbld_MakeFileWriteable(Project.Name)
	' The build succeeded; Save the project without status so it will begin from the start during the next build
	Call Project.Save(Project.Name, vbldSaveStatusExclude)
	' Log a message to indicate that the save happened
	Call Builder.LogMessage("Good Build: Project status is clean")

End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Function DoesProcessIDExist(ProcessID, ServerName)
    Dim wmi, processlist, process
    Set wmi = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & ServerName & "\root\cimv2")
    Set processlist = wmi.ExecQuery("Select * from Win32_Process where ProcessId = '" & ProcessID & "'")
    For Each process In processlist
        DoesProcessIDExist = true
        Exit Function
    Next
    DoesProcessIDExist = false
End Function

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Function CreateProcess(AppExe, ServerName, WaitForCompletion)
	Dim wmi, objProcess, retCode, processID
	Set wmi = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & ServerName & "\root\cimv2")
	Set objProcess = wmi.Get("Win32_Process")
	retCode = objProcess.Create(AppExe, Null, Null, ProcessID)
	If retCode <> 0 Then 'This is just the return code from WMI, not the process return code
		CreateProcess = false
		Exit Function
	End If
	If WaitForCompletion Then
		Do While DoesProcessIDExist(processID, ServerName)
			wscript.Sleep 1000
		Loop
	End If
	CreateProcess = true
End Function]]></script>
</project>